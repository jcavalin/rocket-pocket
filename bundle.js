(function(){function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}return e})()({1:[function(require,module,exports){
var RocketPocketGame = /** @class */ (function () {
    function RocketPocketGame() {
        this.debug = false;
        this.fuel = 500;
        this.accelerationX = 200;
        this.accelerationY = 400;
        this.fuelLabel = 'Fuel';
        this.playingSound = false;
        this.exploded = false;
        this.game = new Phaser.Game(800, 600, Phaser.AUTO, 'content', {
            preload: this.preload.bind(this),
            create: this.create.bind(this),
            update: this.update.bind(this),
            render: this.render.bind(this)
        });
    }
    RocketPocketGame.prototype.preload = function () {
        this.game.load.spritesheet('rocket', 'img/rocket.png', 50, 75, 3);
        this.game.load.spritesheet('explosion', 'img/explosion.png', 64, 64, 23);
        this.game.load.image('background', 'img/lunar-background.png');
        this.game.load.audio('rocket-audio', ['audio/rocket-launch.mp3']);
        this.game.load.audio('rocket-explosion', ['audio/rocket-explosion.mp3']);
        this.game.load.atlas('dpad', 'img/dpad.png', 'img/dpad.json');
    };
    RocketPocketGame.prototype.create = function () {
        this.game.stage.backgroundColor = '#2d2d2d';
        this.game.physics.startSystem(Phaser.Physics.ARCADE);
        this.cursors = this.game.input.keyboard.createCursorKeys();
        this.background = this.game.add.tileSprite(0, 0, 800, 600, 'background');
        this.background.fixedToCamera = true;
        this.game.world.setBounds(0, 0, 2000, 600);
        this.rocketAudio = this.game.add.audio('rocket-audio', 1, true);
        this.rocketAudio.allowMultiple = false;
        this.rocketAudio.addMarker('launching', 0, 10);
        this.rocketExplosion = this.game.add.audio('rocket-explosion', 1, true);
        this.rocketExplosion.allowMultiple = false;
        this.rocketExplosion.addMarker('exploding', 0, 10);
        this.fuelText = this.game.add.text(32, 32, this.fuelLabel + ': ' + this.fuel, {
            font: "20px Arial",
            fill: "#ffffff",
            align: "left"
        });
        this.fuelText.fixedToCamera = true;
        this.fuelText.cameraOffset.setTo(32, 32);
        this.drawGround();
        this.graphics = this.game.add.graphics(0, 0);
        this.graphics.beginFill(0x8e8e8e);
        this.graphics.drawPolygon(this.ground.points);
        this.graphics.endFill();
        this.rocket = this.game.add.sprite(32, 1512, 'rocket');
        this.rocket.animations.add('launching', [1, 2, 3], 10, true);
        this.rocket.anchor = new Phaser.Point(0.5, 0.5);
        this.game.physics.enable([this.rocket], Phaser.Physics.ARCADE);
        this.rocket.body.bounce.set(0);
        this.rocket.body.gravity.set(0, 180);
        this.rocket.body.velocity.setTo(0, 200);
        this.rocket.body.collideWorldBounds = true;
        this.game.camera.follow(this.rocket);
        this.game.camera.deadzone = new Phaser.Rectangle(150, 150, 500, 0);
        this.game.camera.focusOnXY(0, 0);
        // this.pad = this.game.plugins.add(Phaser.VirtualJoystick);
        // this.stick = this.pad.addDPad(0, 0, 200, 'dpad');
        // this.stick.alignBottomLeft(0);
    };
    RocketPocketGame.prototype.update = function () {
        if (this.checkExplosion() && !this.exploded) {
            this.exploding();
        }
        else if (!this.exploded) {
            this.moving();
        }
    };
    RocketPocketGame.prototype.render = function () {
        if (this.debug) {
            this.game.debug.bodyInfo(this.rocket, 32, 32);
            this.game.debug.body(this.rocket);
        }
    };
    RocketPocketGame.prototype.drawGround = function () {
        var highPoint = 100;
        var lowerPoint = 450;
        var groundPoints = [
            new Phaser.Point(0, 600),
            new Phaser.Point(0, 580),
            new Phaser.Point(100, 580) // landing
        ];
        for (var xPoint = 150; xPoint < 1750; xPoint += 50) {
            groundPoints.push(new Phaser.Point(xPoint, (Math.random() * lowerPoint) + highPoint));
        }
        groundPoints.push(new Phaser.Point(1800, 580)); // landing
        groundPoints.push(new Phaser.Point(1900, 580)); // landing
        groundPoints.push(new Phaser.Point(1950, (Math.random() * lowerPoint) + highPoint));
        groundPoints.push(new Phaser.Point(2000, (Math.random() * lowerPoint) + highPoint));
        groundPoints.push(new Phaser.Point(2100, 600));
        this.ground = new Phaser.Polygon();
        this.ground.setTo(groundPoints);
    };
    RocketPocketGame.prototype.consumeFuel = function () {
        if (this.fuel > 0) {
            this.fuel -= 1;
        }
    };
    RocketPocketGame.prototype.playRocketSound = function () {
        if (!this.playingSound) {
            this.rocketAudio.play('launching');
            this.playingSound = true;
        }
    };
    RocketPocketGame.prototype.checkExplosion = function () {
        return this.ground.contains(this.rocket.x, this.rocket.y)
            || (this.rocket.body.onFloor() && this.rocket.body.speed > 203);
    };
    ;
    RocketPocketGame.prototype.isFuelEmpty = function () {
        return this.fuel === 0;
    };
    ;
    RocketPocketGame.prototype.launching = function () {
        this.rocket.animations.play('launching');
        this.playRocketSound();
        this.consumeFuel();
    };
    RocketPocketGame.prototype.setUpExplosionSprite = function () {
        this.explosion = this.game.add.sprite(this.rocket.x, this.rocket.y, 'explosion');
        this.explosion.anchor = new Phaser.Point(0.5, 0.5);
        this.explosion.animations.add('exploding', [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], 10, false);
    };
    RocketPocketGame.prototype.moving = function () {
        if (this.cursors.up.isDown && !this.isFuelEmpty()) {
            this.rocket.body.acceleration.y = -this.accelerationY;
            this.launching();
        }
        else if (this.cursors.left.isDown && !this.isFuelEmpty()) {
            this.rocket.body.acceleration.x = -this.accelerationX;
            this.launching();
        }
        else if (this.cursors.right.isDown && !this.isFuelEmpty()) {
            this.rocket.body.acceleration.x = this.accelerationX;
            this.launching();
        }
        else {
            this.rocket.body.acceleration.setTo(0, 0);
            this.rocket.frame = 0;
            this.rocket.animations.stop();
            this.rocketAudio.stop();
            this.playingSound = false;
        }
        if (this.rocket.body.onFloor()) {
            this.rocket.body.velocity.x = 0;
        }
        this.fuelText.text = this.fuelLabel + ': ' + this.fuel;
        this.background.tilePosition.x = -this.game.camera.x;
        this.background.tilePosition.y = -this.game.camera.y;
    };
    RocketPocketGame.prototype.exploding = function () {
        this.exploded = true;
        this.rocket.body.velocity.x = 0;
        this.rocket.body.velocity.y = 0;
        this.setUpExplosionSprite();
        this.explosion.animations.play('exploding', 10, false, true);
        this.game.world.remove(this.rocket);
        this.rocketAudio.stop();
        this.rocketExplosion.play('exploding');
    };
    return RocketPocketGame;
}());
window.onload = function () {
    new RocketPocketGame();
};
},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvbWFpbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0lBc0JJO1FBckJBLFVBQUssR0FBWSxLQUFLLENBQUM7UUFDdkIsU0FBSSxHQUFXLEdBQUcsQ0FBQztRQUNuQixrQkFBYSxHQUFXLEdBQUcsQ0FBQztRQUM1QixrQkFBYSxHQUFXLEdBQUcsQ0FBQztRQUM1QixjQUFTLEdBQVcsTUFBTSxDQUFDO1FBRTNCLGlCQUFZLEdBQVksS0FBSyxDQUFDO1FBQzlCLGFBQVEsR0FBWSxLQUFLLENBQUM7UUFldEIsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxNQUFNLENBQUMsSUFBSSxFQUFFLFNBQVMsRUFBRTtZQUMxRCxPQUFPLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO1lBQ2hDLE1BQU0sRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUM7WUFDOUIsTUFBTSxFQUFFLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztZQUM5QixNQUFNLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO1NBQ2pDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFRCxrQ0FBTyxHQUFQO1FBQ0ksSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsRUFBRSxnQkFBZ0IsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQ2xFLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxXQUFXLEVBQUUsbUJBQW1CLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUN6RSxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsWUFBWSxFQUFFLDBCQUEwQixDQUFDLENBQUM7UUFDL0QsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLGNBQWMsRUFBRSxDQUFDLHlCQUF5QixDQUFDLENBQUMsQ0FBQztRQUNsRSxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsa0JBQWtCLEVBQUUsQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDLENBQUM7UUFDekUsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRSxjQUFjLEVBQUUsZUFBZSxDQUFDLENBQUM7SUFDbEUsQ0FBQztJQUVELGlDQUFNLEdBQU47UUFDSSxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxlQUFlLEdBQUcsU0FBUyxDQUFDO1FBQzVDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBRXJELElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLGdCQUFnQixFQUFFLENBQUM7UUFFM0QsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLFlBQVksQ0FBQyxDQUFDO1FBQ3pFLElBQUksQ0FBQyxVQUFVLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQztRQUNyQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFFM0MsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsY0FBYyxFQUFFLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUNoRSxJQUFJLENBQUMsV0FBVyxDQUFDLGFBQWEsR0FBRyxLQUFLLENBQUM7UUFDdkMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsV0FBVyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUUvQyxJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxrQkFBa0IsRUFBRSxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDeEUsSUFBSSxDQUFDLGVBQWUsQ0FBQyxhQUFhLEdBQUcsS0FBSyxDQUFDO1FBQzNDLElBQUksQ0FBQyxlQUFlLENBQUMsU0FBUyxDQUFDLFdBQVcsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFFbkQsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxFQUFFO1lBQzFFLElBQUksRUFBRSxZQUFZO1lBQ2xCLElBQUksRUFBRSxTQUFTO1lBQ2YsS0FBSyxFQUFFLE1BQU07U0FDaEIsQ0FBQyxDQUFDO1FBQ0gsSUFBSSxDQUFDLFFBQVEsQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDO1FBQ25DLElBQUksQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFFekMsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBRWxCLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUM3QyxJQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUNsQyxJQUFJLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQzlDLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxFQUFFLENBQUM7UUFFeEIsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLElBQUksRUFBRSxRQUFRLENBQUMsQ0FBQztRQUN2RCxJQUFJLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDN0QsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEdBQUcsSUFBSSxNQUFNLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUNoRCxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUUsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUUvRCxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQy9CLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ3JDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ3hDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLGtCQUFrQixHQUFHLElBQUksQ0FBQztRQUUzQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ3JDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsR0FBRyxJQUFJLE1BQU0sQ0FBQyxTQUFTLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDbkUsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUVqQyw0REFBNEQ7UUFDNUQsb0RBQW9EO1FBQ3BELGlDQUFpQztJQUNyQyxDQUFDO0lBRUQsaUNBQU0sR0FBTjtRQUNJLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxjQUFjLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO1lBQzFDLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUNyQixDQUFDO1FBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7WUFDeEIsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQ2xCLENBQUM7SUFDTCxDQUFDO0lBRUQsaUNBQU0sR0FBTjtRQUNJLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1lBQ2IsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBQzlDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDdEMsQ0FBQztJQUNMLENBQUM7SUFFRCxxQ0FBVSxHQUFWO1FBQ0ksSUFBSSxTQUFTLEdBQUcsR0FBRyxDQUFDO1FBQ3BCLElBQUksVUFBVSxHQUFHLEdBQUcsQ0FBQztRQUNyQixJQUFJLFlBQVksR0FBRztZQUNmLElBQUksTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDO1lBQ3hCLElBQUksTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDO1lBQ3hCLElBQUksTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUUsVUFBVTtTQUN6QyxDQUFDO1FBRUYsR0FBRyxDQUFDLENBQUMsSUFBSSxNQUFNLEdBQUcsR0FBRyxFQUFFLE1BQU0sR0FBRyxJQUFJLEVBQUUsTUFBTSxJQUFJLEVBQUUsRUFBRSxDQUFDO1lBQ2pELFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxNQUFNLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxVQUFVLENBQUMsR0FBRyxTQUFTLENBQUMsQ0FBQyxDQUFDO1FBQzFGLENBQUM7UUFFRCxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVU7UUFDMUQsWUFBWSxDQUFDLElBQUksQ0FBQyxJQUFJLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVO1FBRTFELFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxVQUFVLENBQUMsR0FBRyxTQUFTLENBQUMsQ0FBQyxDQUFDO1FBQ3BGLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxVQUFVLENBQUMsR0FBRyxTQUFTLENBQUMsQ0FBQyxDQUFDO1FBQ3BGLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBRS9DLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxNQUFNLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDbkMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUM7SUFD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SUFBSSxDQUFDLFVBQVUsQ0FBQyxZQUFZLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO0lBQ3pELENBQUM7SUFFRCxvQ0FBUyxHQUFUO1FBQ0ksSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7UUFDckIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDaEMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7UUFFaEMsSUFBSSxDQUFDLG9CQUFvQixFQUFFLENBQUM7UUFDNUIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBRTdELElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDcEMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUV4QixJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUMzQyxDQUFDO0lBQ0wsdUJBQUM7QUFBRCxDQS9NQSxBQStNQyxJQUFBO0FBRUQsTUFBTSxDQUFDLE1BQU0sR0FBRztJQUNaLElBQUksZ0JBQWdCLEVBQUUsQ0FBQztBQUMzQixDQUFDLENBQUMiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfXJldHVybiBlfSkoKSIsImNsYXNzIFJvY2tldFBvY2tldEdhbWUge1xyXG4gICAgZGVidWc6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIGZ1ZWw6IG51bWJlciA9IDUwMDtcclxuICAgIGFjY2VsZXJhdGlvblg6IG51bWJlciA9IDIwMDtcclxuICAgIGFjY2VsZXJhdGlvblk6IG51bWJlciA9IDQwMDtcclxuICAgIGZ1ZWxMYWJlbDogc3RyaW5nID0gJ0Z1ZWwnO1xyXG5cclxuICAgIHBsYXlpbmdTb3VuZDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgZXhwbG9kZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIGdhbWU6IFBoYXNlci5HYW1lO1xyXG4gICAgY3Vyc29yczogUGhhc2VyLkN1cnNvcktleXM7XHJcbiAgICByb2NrZXQ6IFBoYXNlci5TcHJpdGU7XHJcbiAgICBleHBsb3Npb246IFBoYXNlci5TcHJpdGU7XHJcbiAgICByb2NrZXRBdWRpbzogUGhhc2VyLkF1ZGlvU3ByaXRlO1xyXG4gICAgcm9ja2V0RXhwbG9zaW9uOiBQaGFzZXIuQXVkaW9TcHJpdGU7XHJcbiAgICBmdWVsVGV4dDogUGhhc2VyLlRleHQ7XHJcbiAgICBiYWNrZ3JvdW5kOiBQaGFzZXIuVGlsZVNwcml0ZTtcclxuICAgIGdyb3VuZDogUGhhc2VyLlBvbHlnb247XHJcbiAgICBncmFwaGljczogUGhhc2VyLkdyYXBoaWNzO1xyXG4gICAgcGFkOiBQaGFzZXIuVmlydHVhbEpveXN0aWNrO1xyXG4gICAgc3RpY2s6IFBoYXNlci5HYW1lcGFkO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMuZ2FtZSA9IG5ldyBQaGFzZXIuR2FtZSg4MDAsIDYwMCwgUGhhc2VyLkFVVE8sICdjb250ZW50Jywge1xyXG4gICAgICAgICAgICBwcmVsb2FkOiB0aGlzLnByZWxvYWQuYmluZCh0aGlzKSxcclxuICAgICAgICAgICAgY3JlYXRlOiB0aGlzLmNyZWF0ZS5iaW5kKHRoaXMpLFxyXG4gICAgICAgICAgICB1cGRhdGU6IHRoaXMudXBkYXRlLmJpbmQodGhpcyksXHJcbiAgICAgICAgICAgIHJlbmRlcjogdGhpcy5yZW5kZXIuYmluZCh0aGlzKVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByZWxvYWQoKSB7XHJcbiAgICAgICAgdGhpcy5nYW1lLmxvYWQuc3ByaXRlc2hlZXQoJ3JvY2tldCcsICdpbWcvcm9ja2V0LnBuZycsIDUwLCA3NSwgMyk7XHJcbiAgICAgICAgdGhpcy5nYW1lLmxvYWQuc3ByaXRlc2hlZXQoJ2V4cGxvc2lvbicsICdpbWcvZXhwbG9zaW9uLnBuZycsIDY0LCA2NCwgMjMpO1xyXG4gICAgICAgIHRoaXMuZ2FtZS5sb2FkLmltYWdlKCdiYWNrZ3JvdW5kJywgJ2ltZy9sdW5hci1iYWNrZ3JvdW5kLnBuZycpO1xyXG4gICAgICAgIHRoaXMuZ2FtZS5sb2FkLmF1ZGlvKCdyb2NrZXQtYXVkaW8nLCBbJ2F1ZGlvL3JvY2tldC1sYXVuY2gubXAzJ10pO1xyXG4gICAgICAgIHRoaXMuZ2FtZS5sb2FkLmF1ZGlvKCdyb2NrZXQtZXhwbG9zaW9uJywgWydhdWRpby9yb2NrZXQtZXhwbG9zaW9uLm1wMyddKTtcclxuICAgICAgICB0aGlzLmdhbWUubG9hZC5hdGxhcygnZHBhZCcsICdpbWcvZHBhZC5wbmcnLCAnaW1nL2RwYWQuanNvbicpO1xyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZSgpIHtcclxuICAgICAgICB0aGlzLmdhbWUuc3RhZ2UuYmFja2dyb3VuZENvbG9yID0gJyMyZDJkMmQnO1xyXG4gICAgICAgIHRoaXMuZ2FtZS5waHlzaWNzLnN0YXJ0U3lzdGVtKFBoYXNlci5QaHlzaWNzLkFSQ0FERSk7XHJcblxyXG4gICAgICAgIHRoaXMuY3Vyc29ycyA9IHRoaXMuZ2FtZS5pbnB1dC5rZXlib2FyZC5jcmVhdGVDdXJzb3JLZXlzKCk7XHJcblxyXG4gICAgICAgIHRoaXMuYmFja2dyb3VuZCA9IHRoaXMuZ2FtZS5hZGQudGlsZVNwcml0ZSgwLCAwLCA4MDAsIDYwMCwgJ2JhY2tncm91bmQnKTtcclxuICAgICAgICB0aGlzLmJhY2tncm91bmQuZml4ZWRUb0NhbWVyYSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5nYW1lLndvcmxkLnNldEJvdW5kcygwLCAwLCAyMDAwLCA2MDApO1xyXG5cclxuICAgICAgICB0aGlzLnJvY2tldEF1ZGlvID0gdGhpcy5nYW1lLmFkZC5hdWRpbygncm9ja2V0LWF1ZGlvJywgMSwgdHJ1ZSk7XHJcbiAgICAgICAgdGhpcy5yb2NrZXRBdWRpby5hbGxvd011bHRpcGxlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5yb2NrZXRBdWRpby5hZGRNYXJrZXIoJ2xhdW5jaGluZycsIDAsIDEwKTtcclxuXHJcbiAgICAgICAgdGhpcy5yb2NrZXRFeHBsb3Npb24gPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKCdyb2NrZXQtZXhwbG9zaW9uJywgMSwgdHJ1ZSk7XHJcbiAgICAgICAgdGhpcy5yb2NrZXRFeHBsb3Npb24uYWxsb3dNdWx0aXBsZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMucm9ja2V0RXhwbG9zaW9uLmFkZE1hcmtlcignZXhwbG9kaW5nJywgMCwgMTApO1xyXG5cclxuICAgICAgICB0aGlzLmZ1ZWxUZXh0ID0gdGhpcy5nYW1lLmFkZC50ZXh0KDMyLCAzMiwgdGhpcy5mdWVsTGFiZWwgKyAnOiAnICsgdGhpcy5mdWVsLCB7XHJcbiAgICAgICAgICAgIGZvbnQ6IFwiMjBweCBBcmlhbFwiLFxyXG4gICAgICAgICAgICBmaWxsOiBcIiNmZmZmZmZcIixcclxuICAgICAgICAgICAgYWxpZ246IFwibGVmdFwiXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5mdWVsVGV4dC5maXhlZFRvQ2FtZXJhID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmZ1ZWxUZXh0LmNhbWVyYU9mZnNldC5zZXRUbygzMiwgMzIpO1xyXG5cclxuICAgICAgICB0aGlzLmRyYXdHcm91bmQoKTtcclxuXHJcbiAgICAgICAgdGhpcy5ncmFwaGljcyA9IHRoaXMuZ2FtZS5hZGQuZ3JhcGhpY3MoMCwgMCk7XHJcbiAgICAgICAgdGhpcy5ncmFwaGljcy5iZWdpbkZpbGwoMHg4ZThlOGUpO1xyXG4gICAgICAgIHRoaXMuZ3JhcGhpY3MuZHJhd1BvbHlnb24odGhpcy5ncm91bmQucG9pbnRzKTtcclxuICAgICAgICB0aGlzLmdyYXBoaWNzLmVuZEZpbGwoKTtcclxuXHJcbiAgICAgICAgdGhpcy5yb2NrZXQgPSB0aGlzLmdhbWUuYWRkLnNwcml0ZSgzMiwgMTUxMiwgJ3JvY2tldCcpO1xyXG4gICAgICAgIHRoaXMucm9ja2V0LmFuaW1hdGlvbnMuYWRkKCdsYXVuY2hpbmcnLCBbMSwgMiwgM10sIDEwLCB0cnVlKTtcclxuICAgICAgICB0aGlzLnJvY2tldC5hbmNob3IgPSBuZXcgUGhhc2VyLlBvaW50KDAuNSwgMC41KTtcclxuICAgICAgICB0aGlzLmdhbWUucGh5c2ljcy5lbmFibGUoW3RoaXMucm9ja2V0XSwgUGhhc2VyLlBoeXNpY3MuQVJDQURFKTtcclxuXHJcbiAgICAgICAgdGhpcy5yb2NrZXQuYm9keS5ib3VuY2Uuc2V0KDApO1xyXG4gICAgICAgIHRoaXMucm9ja2V0LmJvZHkuZ3Jhdml0eS5zZXQoMCwgMTgwKTtcclxuICAgICAgICB0aGlzLnJvY2tldC5ib2R5LnZlbG9jaXR5LnNldFRvKDAsIDIwMCk7XHJcbiAgICAgICAgdGhpcy5yb2NrZXQuYm9keS5jb2xsaWRlV29ybGRCb3VuZHMgPSB0cnVlO1xyXG5cclxuICAgICAgICB0aGlzLmdhbWUuY2FtZXJhLmZvbGxvdyh0aGlzLnJvY2tldCk7XHJcbiAgICAgICAgdGhpcy5nYW1lLmNhbWVyYS5kZWFkem9uZSA9IG5ldyBQaGFzZXIuUmVjdGFuZ2xlKDE1MCwgMTUwLCA1MDAsIDApO1xyXG4gICAgICAgIHRoaXMuZ2FtZS5jYW1lcmEuZm9jdXNPblhZKDAsIDApO1xyXG5cclxuICAgICAgICAvLyB0aGlzLnBhZCA9IHRoaXMuZ2FtZS5wbHVnaW5zLmFkZChQaGFzZXIuVmlydHVhbEpveXN0aWNrKTtcclxuICAgICAgICAvLyB0aGlzLnN0aWNrID0gdGhpcy5wYWQuYWRkRFBhZCgwLCAwLCAyMDAsICdkcGFkJyk7XHJcbiAgICAgICAgLy8gdGhpcy5zdGljay5hbGlnbkJvdHRvbUxlZnQoMCk7XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmNoZWNrRXhwbG9zaW9uKCkgJiYgIXRoaXMuZXhwbG9kZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5leHBsb2RpbmcoKTtcclxuICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLmV4cGxvZGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMubW92aW5nKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBpZiAodGhpcy5kZWJ1Zykge1xyXG4gICAgICAgICAgICB0aGlzLmdhbWUuZGVidWcuYm9keUluZm8odGhpcy5yb2NrZXQsIDMyLCAzMik7XHJcbiAgICAgICAgICAgIHRoaXMuZ2FtZS5kZWJ1Zy5ib2R5KHRoaXMucm9ja2V0KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZHJhd0dyb3VuZCgpIHtcclxuICAgICAgICBsZXQgaGlnaFBvaW50ID0gMTAwO1xyXG4gICAgICAgIGxldCBsb3dlclBvaW50ID0gNDUwO1xyXG4gICAgICAgIGxldCBncm91bmRQb2ludHMgPSBbXHJcbiAgICAgICAgICAgIG5ldyBQaGFzZXIuUG9pbnQoMCwgNjAwKSxcclxuICAgICAgICAgICAgbmV3IFBoYXNlci5Qb2ludCgwLCA1ODApLCAvLyBsYW5kaW5nXHJcbiAgICAgICAgICAgIG5ldyBQaGFzZXIuUG9pbnQoMTAwLCA1ODApICAvLyBsYW5kaW5nXHJcbiAgICAgICAgXTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgeFBvaW50ID0gMTUwOyB4UG9pbnQgPCAxNzUwOyB4UG9pbnQgKz0gNTApIHtcclxuICAgICAgICAgICAgZ3JvdW5kUG9pbnRzLnB1c2gobmV3IFBoYXNlci5Qb2ludCh4UG9pbnQsIChNYXRoLnJhbmRvbSgpICogbG93ZXJQb2ludCkgKyBoaWdoUG9pbnQpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGdyb3VuZFBvaW50cy5wdXNoKG5ldyBQaGFzZXIuUG9pbnQoMTgwMCwgNTgwKSk7IC8vIGxhbmRpbmdcclxuICAgICAgICBncm91bmRQb2ludHMucHVzaChuZXcgUGhhc2VyLlBvaW50KDE5MDAsIDU4MCkpOyAvLyBsYW5kaW5nXHJcblxyXG4gICAgICAgIGdyb3VuZFBvaW50cy5wdXNoKG5ldyBQaGFzZXIuUG9pbnQoMTk1MCwgKE1hdGgucmFuZG9tKCkgKiBsb3dlclBvaW50KSArIGhpZ2hQb2ludCkpO1xyXG4gICAgICAgIGdyb3VuZFBvaW50cy5wdXNoKG5ldyBQaGFzZXIuUG9pbnQoMjAwMCwgKE1hdGgucmFuZG9tKCkgKiBsb3dlclBvaW50KSArIGhpZ2hQb2ludCkpO1xyXG4gICAgICAgIGdyb3VuZFBvaW50cy5wdXNoKG5ldyBQaGFzZXIuUG9pbnQoMjEwMCwgNjAwKSk7XHJcblxyXG4gICAgICAgIHRoaXMuZ3JvdW5kID0gbmV3IFBoYXNlci5Qb2x5Z29uKCk7XHJcbiAgICAgICAgdGhpcy5ncm91bmQuc2V0VG8oZ3JvdW5kUG9pbnRzKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdW1lRnVlbCgpIHtcclxuICAgICAgICBpZiAodGhpcy5mdWVsID4gMCkge1xyXG4gICAgICAgICAgICB0aGlzLmZ1ZWwgLT0gMTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcGxheVJvY2tldFNvdW5kKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5wbGF5aW5nU291bmQpIHtcclxuICAgICAgICAgICAgdGhpcy5yb2NrZXRBdWRpby5wbGF5KCdsYXVuY2hpbmcnKTtcclxuICAgICAgICAgICAgdGhpcy5wbGF5aW5nU291bmQgPSB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNoZWNrRXhwbG9zaW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdyb3VuZC5jb250YWlucyh0aGlzLnJvY2tldC54LCB0aGlzLnJvY2tldC55KVxyXG4gICAgICAgICAgICB8fCAodGhpcy5yb2NrZXQuYm9keS5vbkZsb29yKCkgJiYgdGhpcy5yb2NrZXQuYm9keS5zcGVlZCA+IDIwMylcclxuICAgIH07XHJcblxyXG4gICAgaXNGdWVsRW1wdHkoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZnVlbCA9PT0gMDtcclxuICAgIH07XHJcblxyXG4gICAgbGF1bmNoaW5nKCkge1xyXG4gICAgICAgIHRoaXMucm9ja2V0LmFuaW1hdGlvbnMucGxheSgnbGF1bmNoaW5nJyk7XHJcbiAgICAgICAgdGhpcy5wbGF5Um9ja2V0U291bmQoKTtcclxuICAgICAgICB0aGlzLmNvbnN1bWVGdWVsKCk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0VXBFeHBsb3Npb25TcHJpdGUoKSB7XHJcbiAgICAgICAgdGhpcy5leHBsb3Npb24gPSB0aGlzLmdhbWUuYWRkLnNwcml0ZSh0aGlzLnJvY2tldC54LCB0aGlzLnJvY2tldC55LCAnZXhwbG9zaW9uJyk7XHJcbiAgICAgICAgdGhpcy5leHBsb3Npb24uYW5jaG9yID0gbmV3IFBoYXNlci5Qb2ludCgwLjUsIDAuNSk7XHJcbiAgICAgICAgdGhpcy5leHBsb3Npb24uYW5pbWF0aW9ucy5hZGQoJ2V4cGxvZGluZycsXHJcbiAgICAgICAgICAgIFsxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMCwgMTEsIDEyLCAxMywgMTQsIDE1LCAxNiwgMTcsIDE4LCAxOSwgMjAsIDIxLCAyMiwgMjNdLCAxMCwgZmFsc2UpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb3ZpbmcoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY3Vyc29ycy51cC5pc0Rvd24gJiYgIXRoaXMuaXNGdWVsRW1wdHkoKSkge1xyXG4gICAgICAgICAgICB0aGlzLnJvY2tldC5ib2R5LmFjY2VsZXJhdGlvbi55ID0gLXRoaXMuYWNjZWxlcmF0aW9uWTtcclxuICAgICAgICAgICAgdGhpcy5sYXVuY2hpbmcoKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuY3Vyc29ycy5sZWZ0LmlzRG93biAmJiAhdGhpcy5pc0Z1ZWxFbXB0eSgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMucm9ja2V0LmJvZHkuYWNjZWxlcmF0aW9uLnggPSAtdGhpcy5hY2NlbGVyYXRpb25YO1xyXG4gICAgICAgICAgICB0aGlzLmxhdW5jaGluZygpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5jdXJzb3JzLnJpZ2h0LmlzRG93biAmJiAhdGhpcy5pc0Z1ZWxFbXB0eSgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMucm9ja2V0LmJvZHkuYWNjZWxlcmF0aW9uLnggPSB0aGlzLmFjY2VsZXJhdGlvblg7XHJcbiAgICAgICAgICAgIHRoaXMubGF1bmNoaW5nKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5yb2NrZXQuYm9keS5hY2NlbGVyYXRpb24uc2V0VG8oMCwgMCk7XHJcbiAgICAgICAgICAgIHRoaXMucm9ja2V0LmZyYW1lID0gMDtcclxuICAgICAgICAgICAgdGhpcy5yb2NrZXQuYW5pbWF0aW9ucy5zdG9wKCk7XHJcbiAgICAgICAgICAgIHRoaXMucm9ja2V0QXVkaW8uc3RvcCgpO1xyXG4gICAgICAgICAgICB0aGlzLnBsYXlpbmdTb3VuZCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMucm9ja2V0LmJvZHkub25GbG9vcigpKSB7XHJcbiAgICAgICAgICAgIHRoaXMucm9ja2V0LmJvZHkudmVsb2NpdHkueCA9IDA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmZ1ZWxUZXh0LnRleHQgPSB0aGlzLmZ1ZWxMYWJlbCArICc6ICcgKyB0aGlzLmZ1ZWw7XHJcbiAgICAgICAgdGhpcy5iYWNrZ3JvdW5kLnRpbGVQb3NpdGlvbi54ID0gLXRoaXMuZ2FtZS5jYW1lcmEueDtcclxuICAgICAgICB0aGlzLmJhY2tncm91bmQudGlsZVBvc2l0aW9uLnkgPSAtdGhpcy5nYW1lLmNhbWVyYS55O1xyXG4gICAgfVxyXG5cclxuICAgIGV4cGxvZGluZygpIHtcclxuICAgICAgICB0aGlzLmV4cGxvZGVkID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnJvY2tldC5ib2R5LnZlbG9jaXR5LnggPSAwO1xyXG4gICAgICAgIHRoaXMucm9ja2V0LmJvZHkudmVsb2NpdHkueSA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0VXBFeHBsb3Npb25TcHJpdGUoKTtcclxuICAgICAgICB0aGlzLmV4cGxvc2lvbi5hbmltYXRpb25zLnBsYXkoJ2V4cGxvZGluZycsIDEwLCBmYWxzZSwgdHJ1ZSk7XHJcblxyXG4gICAgICAgIHRoaXMuZ2FtZS53b3JsZC5yZW1vdmUodGhpcy5yb2NrZXQpO1xyXG4gICAgICAgIHRoaXMucm9ja2V0QXVkaW8uc3RvcCgpO1xyXG5cclxuICAgICAgICB0aGlzLnJvY2tldEV4cGxvc2lvbi5wbGF5KCdleHBsb2RpbmcnKTtcclxuICAgIH1cclxufVxyXG5cclxud2luZG93Lm9ubG9hZCA9ICgpID0+IHtcclxuICAgIG5ldyBSb2NrZXRQb2NrZXRHYW1lKCk7XHJcbn07Il19
